//{namespace name="backend/viison_ups_order/order"}
Ext.define("Shopware.apps.ViisonUPSOrder.controller.Tab",{ extend:"Shopware.apps.ViisonShippingCommonOrder.controller.Tab",requires:"Shopware.apps.ViisonUPSShipping",dispatchServiceProviderPrefix:"ViisonUPS",dispatchServiceProviderPanelClass:"order-viison-ups-tab",productStoreClass:"Shopware.apps.ViisonUPSShipping.store.Product",labelConfirmPanelClass:"Shopware.apps.ViisonUPSOrder.view.detail.LabelConfirm",shippingLabelClass:"Shopware.apps.ViisonUPSOrder.model.ShippingLabel",sendMailURL:'{url controller="ViisonUPSOrder" action="sendMail"}',downloadDocumentsURL:'{url controller="ViisonUPSOrder" action="downloadDocuments"}',calculateShippingWeightURL:'{url controller="ViisonUPSOrder" action="calculateShippingWeight"}',getRequiredFieldsURL:'{url controller="ViisonUPSOrder" action="getRequiredFields"}',getProductURL:'{url controller="ViisonUPSOrder" action="getProduct"}',dispatchServiceProviderCSSClass:Ext.baseCSSPrefix+"ups",dispatchServiceProviderLabelConfirmPanel:"order-viison-ups-label-confirm-panel",listDispatchActionsControllerClass:"Shopware.apps.ViisonUPSOrder.controller.ListDispatchActions",maxNumberOfLabels:{$pluginInfo->getMaxLabels()},customSnippets:{ notifications:{ growlMessage:'{s name=detail/notifications/growlMessage}{/s}'}},updatePackagingType:function(i){ var e=this;Ext.Ajax.request({ url:'{url controller="ViisonUPSOrder" action="getDefaultPackagingType"}',params:{ orderId:i.getId()},success:function(s){ var l=Ext.JSON.decode(s.responseText);i.ViisonUPS=i.ViisonUPS||{ };i.ViisonUPS.packagingType=l.defaultPackagingType;if(e.getLabelConfirmWindow()&&e.getLabelConfirmWindow().dataPanel){ e.getLabelConfirmWindow().dataPanel.setValues()}}})},updateResidentialAddress:function(i){ var e=this;Ext.Ajax.request({ url:'{url controller="ViisonUPSOrder" action="getResidentialAddress"}',params:{ orderId:i.getId()},success:function(s){ var l=Ext.JSON.decode(s.responseText);i.ViisonUPS=i.ViisonUPS||{ };i.ViisonUPS.residentialAddress=l.residentialAddress;if(e.getLabelConfirmWindow()&&e.getLabelConfirmWindow().dataPanel){ e.getLabelConfirmWindow().dataPanel.setValues()}}})},loadDataForOrder:function(i){ var e=this;e.callParent(arguments);this.updatePackagingType(i);this.updateResidentialAddress(i)}});
