//{namespace name="backend/viison_shipping_common_shipping/shipping"}
Ext.define("Shopware.apps.ViisonShippingCommonShipping.view.edit.MappingPanel",{ extend:"Ext.form.Panel",alias:"widget.shipping-viison-shipping-common-mapping-panel",cls:Ext.baseCSSPrefix+"shipping-viison-shipping-common-mapping-panel",layout:{ align:"stretch",type:"vbox"},flex:1,bodyPadding:"10 10 0 10",border:0,collapsible:false,defaults:{ flex:1,labelWidth:150},snippets:{ labels:{ product:'{s name=mapping_panel/labels/product}{/s}',exportDocument:'{s name=mapping_panel/labels/export_document}{/s}'},products:{ none:'{s name=mapping_panel/products/none}{/s}'}},initComponent:function(){ var e=this;e.items=e.getItems();if(e.productStore.find("id",0)===-1){ e.productStore.insert(0,{ id:0,name:e.snippets.products.none,code:""})}if(!e.record.get("clone")&&!e.record.phantom){ e.productMappingStore.getProxy().extraParams={ dispatchId:e.record.internalId};e.productMappingStore.load({ callback:function(t,i,a){ if(a){ e.setValues()}}})}e.callParent(arguments);if(e.record.get("clone")&&e.record.data.id!=0&&e.productMappingStore.data.keys.indexOf(e.record.data.id)==-1){ var t=Ext.create(e.productMappingStoreClass);t.getProxy().extraParams={ dispatchId:e.record.data.id};t.load({ callback:function(t,i,a){ if(a&&t.length>0&&t[0].data.productId!==undefined){ e.setMappingValues(t[0])}else{ e.setMappingValues(null)}e.productMapping=undefined}})}else if(e.record.get("clone")||e.record.phantom){ e.setMappingValues(null)}},getItems:function(){ var e=this;return[e.createMappingItem(),e.createExportDocumentItem()]},createMappingItem:function(){ return{ xtype:"combobox",name:"product",fieldLabel:Ext.String.format(this.snippets.labels.product,this.dispatchServiceProviderName),valueField:"id",displayField:"name",queryMode:"local",mode:"local",required:false,editable:false,allowBlank:true,store:this.productStore}},createExportDocumentItem:function(){ var e=this;return{ xtype:"checkbox",name:"exportDocumentRequired",fieldLabel:e.snippets.labels.exportDocument,required:false,checked:false,hidden:!e.exportDocumentEnabled}},setValues:function(){ if(this.productMappingStore.data.length===1){ this.productMapping=this.productMappingStore.data.items[0];this.setMappingValues(this.productMapping)}else{ this.setMappingValues(null)}},setMappingValues:function(e){ var t={ product:0};if(e!==null){ var i=this.productStore.findExact("id",e.get("productId"));var a=this.productStore.getAt(i);if(a!==undefined){ t.product=a.data.id}Ext.iterate(e.data,function(e,i){ if(!(e in["dispatchId","productId"])){ t[e]=i}})}this.getForm().setValues(t)}});
