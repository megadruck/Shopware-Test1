Ext.define("Shopware.apps.ViisonShippingCommonDailyClosing.controller.Main",{ extend:"Ext.app.Controller",mainWindow:null,init:function(){ this.shopStore=Ext.create("Shopware.apps.ViisonShippingCommonDailyClosing.store.Shop").load({ scope:this,callback:function(){ this.mainWindow=this.getView("main.Window").create({ shopStore:this.shopStore})}});this.control({ "viison_shipping_common_daily_closing-main_window":{ showManifest:this.onShowManifest},"viison_shipping_common_daily_closing-main_window button[action=cancel]":{ click:this.onCancel}});this.callParent(arguments)},onShowManifest:function(i){ if(!i.isValid()){ return}var o=i.getFieldValues();if(o.shop==null){ o.shop=0}var n=this.getFormattedDate(o.fromDate),t=this.getFormattedDate(o.toDate);var e=this.getDailyClosingURL+"?shopId="+o.shop+"&from="+n+"&to="+t;window.open(e,"_blank")},onCancel:function(i,o,n){ this.mainWindow.close()},getFormattedDate:function(i){ var o=i.getDate()+"",n=i.getMonth()+1+"",t=i.getFullYear()+"";o=o.length===1?"0"+o:o;n=n.length===1?"0"+n:n;return t+"-"+n+"-"+o}});
